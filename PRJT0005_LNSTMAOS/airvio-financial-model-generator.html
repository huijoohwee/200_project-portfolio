<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRVIO - è´¢åŠ¡æ¨¡å‹ç”Ÿæˆå™¨</title>
    <style>
        /* MacOSé£æ ¼å˜é‡ */
        :root {
            --primary-color: #007AFF;
            --secondary-color: #5856D6;
            --success-color: #34C759;
            --warning-color: #FF9500;
            --error-color: #FF3B30;
            --background-color: #F2F2F7;
            --surface-color: #FFFFFF;
            --text-primary: #000000;
            --text-secondary: #8E8E93;
            --border-color: #C6C6C8;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
            background: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
            padding: 0 20px;
            box-shadow: var(--shadow);
            z-index: 1000;
            position: fixed;
            width: 100%;
            top: 0;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--success-color), var(--primary-color));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .brand-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-left: 8px;
        }

        .nav-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #0056CC;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #28A745;
        }

        .btn-secondary {
            background: var(--background-color);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
            margin-top: 60px;
            gap: 1px;
            background: var(--border-color);
        }

        /* å·¦ä¾§å‚æ•°é…ç½®é¢æ¿ */
        .sidebar {
            width: 350px;
            background: var(--surface-color);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .sidebar-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .config-section {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .input-group {
            display: flex;
            gap: 8px;
        }

        .input-group .form-input {
            flex: 1;
        }

        .currency-symbol {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .content-area {
            flex: 1;
            background: var(--surface-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-title {
            font-size: 20px;
            font-weight: 600;
        }

        .model-tabs {
            display: flex;
            gap: 2px;
            background: var(--background-color);
            border-radius: var(--border-radius);
            padding: 2px;
        }

        .tab-button {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
        }

        .tab-button.active {
            background: white;
            color: var(--primary-color);
            font-weight: 500;
        }

        /* è´¢åŠ¡æ¨¡å‹å†…å®¹ */
        .financial-model {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .model-section {
            margin-bottom: 32px;
            padding: 24px;
            background: var(--background-color);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        }

        .model-section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .metric-card {
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .metric-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .metric-trend {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }

        .trend-positive {
            background: rgba(52, 199, 89, 0.1);
            color: var(--success-color);
        }

        .trend-negative {
            background: rgba(255, 59, 48, 0.1);
            color: var(--error-color);
        }

        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .metric-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            height: 300px;
            background: white;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            margin-top: 16px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .financial-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid var(--border-color);
            margin-top: 16px;
        }

        .financial-table th,
        .financial-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .financial-table th {
            background: var(--background-color);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .financial-table td {
            font-size: 14px;
        }

        .financial-table tr:last-child td {
            border-bottom: none;
        }

        .financial-table .number {
            text-align: right;
            font-family: 'SF Mono', Monaco, monospace;
        }

        .financial-table .positive {
            color: var(--success-color);
        }

        .financial-table .negative {
            color: var(--error-color);
        }

        /* è¿›åº¦æŒ‡ç¤ºå™¨ */
        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 100px;
            height: 4px;
            background: var(--background-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-color);
            transition: width 0.3s ease;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 300px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .model-section {
            animation: fadeInUp 0.5s ease-out;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--text-secondary);
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* éšè—éæ´»åŠ¨æ ‡ç­¾é¡µ */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-brand">
            <div class="logo">FM</div>
            <div>
                <div class="brand-text">AIRVIO Financial Model</div>
                <div class="subtitle">æ™ºèƒ½è´¢åŠ¡æ¨¡å‹ç”Ÿæˆå™¨</div>
            </div>
        </div>
        <div class="nav-actions">
            <button class="btn btn-secondary" onclick="exportModel()">ğŸ“Š å¯¼å‡ºExcel</button>
            <button class="btn btn-success" onclick="calculateModel()">ğŸ’° è®¡ç®—æ¨¡å‹</button>
            <button class="btn btn-primary" onclick="generateModel()">ğŸš€ ç”Ÿæˆæ¨¡å‹</button>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <!-- å·¦ä¾§å‚æ•°é…ç½®é¢æ¿ -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">æ¨¡å‹å‚æ•°</div>
                <div class="sidebar-subtitle">åŸºäºAIRVIOåŠ¨æ€å­—æ®µç³»ç»Ÿ</div>
            </div>

            <!-- Tokené¢„ç®—é…ç½® -->
            <div class="config-section">
                <div class="section-title">ğŸ’° Tokené¢„ç®—</div>
                <div class="form-group">
                    <label class="form-label">æ€»Tokené¢„ç®—</label>
                    <input type="number" class="form-input" id="totalTokenBudget" value="53000" placeholder="53000">
                </div>
                <div class="form-group">
                    <label class="form-label">æ•ˆç‡ç›®æ ‡</label>
                    <input type="text" class="form-input" id="efficiencyTarget" value="85" placeholder="85">%
                </div>
                <div class="form-group">
                    <label class="form-label">æˆæœ¬èŠ‚çœç‡</label>
                    <input type="text" class="form-input" id="costSavings" value="45" placeholder="45">%
                </div>
            </div>

            <!-- æ”¶å…¥æ¨¡å‹ -->
            <div class="config-section">
                <div class="section-title">ğŸ“ˆ æ”¶å…¥æ¨¡å‹</div>
                <div class="form-group">
                    <label class="form-label">æœˆåº¦ç”¨æˆ·å¢é•¿ç‡</label>
                    <input type="number" class="form-input" id="userGrowthRate" value="20" placeholder="20">%
                </div>
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·è½¬åŒ–ç‡</label>
                    <input type="number" class="form-input" id="conversionRate" value="15" placeholder="15">%
                </div>
                <div class="form-group">
                    <label class="form-label">å¹³å‡å®¢å•ä»· (Â¥)</label>
                    <input type="number" class="form-input" id="averageRevenue" value="299" placeholder="299">
                </div>
            </div>

            <!-- æˆæœ¬ç»“æ„ -->
            <div class="config-section">
                <div class="section-title">ğŸ“Š æˆæœ¬ç»“æ„</div>
                <div class="form-group">
                    <label class="form-label">AIæœåŠ¡æˆæœ¬ (Â¥/æœˆ)</label>
                    <input type="number" class="form-input" id="aiServiceCost" value="8000" placeholder="8000">
                </div>
                <div class="form-group">
                    <label class="form-label">äººåŠ›æˆæœ¬ (Â¥/æœˆ)</label>
                    <input type="number" class="form-input" id="laborCost" value="25000" placeholder="25000">
                </div>
                <div class="form-group">
                    <label class="form-label">è¿è¥æˆæœ¬ (Â¥/æœˆ)</label>
                    <input type="number" class="form-input" id="operatingCost" value="5000" placeholder="5000">
                </div>
            </div>

            <!-- æŠ•èµ„å‚æ•° -->
            <div class="config-section">
                <div class="section-title">ğŸ’¼ æŠ•èµ„å‚æ•°</div>
                <div class="form-group">
                    <label class="form-label">åˆå§‹æŠ•èµ„ (Â¥)</label>
                    <input type="number" class="form-input" id="initialInvestment" value="500000" placeholder="500000">
                </div>
                <div class="form-group">
                    <label class="form-label">é¢„æœŸROI</label>
                    <input type="text" class="form-input" id="expectedROI" value="300" placeholder="300">%
                </div>
                <div class="form-group">
                    <label class="form-label">å›æ”¶æœŸ (æœˆ)</label>
                    <input type="number" class="form-input" id="paybackPeriod" value="12" placeholder="12">
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="content-area">
            <div class="content-header">
                <div class="content-title">è´¢åŠ¡æ¨¡å‹åˆ†æ</div>
                <div class="model-tabs">
                    <button class="tab-button active" onclick="switchTab('overview')">æ¦‚è§ˆ</button>
                    <button class="tab-button" onclick="switchTab('revenue')">æ”¶å…¥</button>
                    <button class="tab-button" onclick="switchTab('costs')">æˆæœ¬</button>
                    <button class="tab-button" onclick="switchTab('cashflow')">ç°é‡‘æµ</button>
                    <button class="tab-button" onclick="switchTab('roi')">ROIåˆ†æ</button>
                </div>
            </div>

            <div class="financial-model" id="financialModel">
                <!-- æ¦‚è§ˆæ ‡ç­¾é¡µ -->
                <div id="overview" class="tab-content active">
                    <div class="model-section">
                        <div class="model-section-title">ğŸ“Š æ ¸å¿ƒè´¢åŠ¡æŒ‡æ ‡</div>
                        <div class="metrics-grid" id="coreMetrics">
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">æœˆåº¦ç»å¸¸æ€§æ”¶å…¥ (MRR)</div>
                                    <div class="metric-trend trend-positive">â†— +25%</div>
                                </div>
                                <div class="metric-value" id="mrrValue">Â¥0</div>
                                <div class="metric-description">åŸºäºç”¨æˆ·å¢é•¿å’Œè½¬åŒ–ç‡è®¡ç®—</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å¹´åº¦ç»å¸¸æ€§æ”¶å…¥ (ARR)</div>
                                    <div class="metric-trend trend-positive">â†— +300%</div>
                                </div>
                                <div class="metric-value" id="arrValue">Â¥0</div>
                                <div class="metric-description">å¹´åŒ–æ”¶å…¥é¢„æµ‹</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">æ¯›åˆ©ç‡</div>
                                    <div class="metric-trend trend-positive">â†— +15%</div>
                                </div>
                                <div class="metric-value" id="grossMargin">0%</div>
                                <div class="metric-description">æ”¶å…¥å‡å»ç›´æ¥æˆæœ¬</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å‡€åˆ©æ¶¦ç‡</div>
                                    <div class="metric-trend trend-positive">â†— +20%</div>
                                </div>
                                <div class="metric-value" id="netMargin">0%</div>
                                <div class="metric-description">æ‰£é™¤æ‰€æœ‰æˆæœ¬åçš„åˆ©æ¶¦ç‡</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å®¢æˆ·è·å–æˆæœ¬ (CAC)</div>
                                    <div class="metric-trend trend-negative">â†˜ -30%</div>
                                </div>
                                <div class="metric-value" id="cacValue">Â¥0</div>
                                <div class="metric-description">è·å–å•ä¸ªå®¢æˆ·çš„æˆæœ¬</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ (LTV)</div>
                                    <div class="metric-trend trend-positive">â†— +150%</div>
                                </div>
                                <div class="metric-value" id="ltvValue">Â¥0</div>
                                <div class="metric-description">å•ä¸ªå®¢æˆ·çš„æ€»ä»·å€¼</div>
                            </div>
                        </div>
                    </div>

                    <div class="model-section">
                        <div class="model-section-title">ğŸ’° Tokenç»æµåˆ†æ</div>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">Tokené¢„ç®—ä½¿ç”¨ç‡</div>
                                    <div class="metric-trend trend-positive">â†— 85%</div>
                                </div>
                                <div class="metric-value" id="tokenUsage">0%</div>
                                <div class="metric-description">å½“å‰Tokené¢„ç®—ä½¿ç”¨æƒ…å†µ</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">Tokenæˆæœ¬èŠ‚çœ</div>
                                    <div class="metric-trend trend-positive">â†— 45%</div>
                                </div>
                                <div class="metric-value" id="tokenSavings">Â¥0</div>
                                <div class="metric-description">ç›¸æ¯”ä¼ ç»Ÿæ–¹å¼èŠ‚çœçš„æˆæœ¬</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">AIæ•ˆç‡æå‡</div>
                                    <div class="metric-trend trend-positive">â†— 3x</div>
                                </div>
                                <div class="metric-value">300%</div>
                                <div class="metric-description">AIåŸç”Ÿæ¶æ„å¸¦æ¥çš„æ•ˆç‡æå‡</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ”¶å…¥æ ‡ç­¾é¡µ -->
                <div id="revenue" class="tab-content">
                    <div class="model-section">
                        <div class="model-section-title">ğŸ“ˆ æ”¶å…¥é¢„æµ‹æ¨¡å‹</div>
                        <div class="chart-container">
                            ğŸ“Š æ”¶å…¥å¢é•¿è¶‹åŠ¿å›¾ (é›†æˆChart.jsåæ˜¾ç¤º)
                        </div>
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>æœˆä»½</th>
                                    <th>æ–°å¢ç”¨æˆ·</th>
                                    <th>ä»˜è´¹ç”¨æˆ·</th>
                                    <th>æœˆåº¦æ”¶å…¥</th>
                                    <th>ç´¯è®¡æ”¶å…¥</th>
                                </tr>
                            </thead>
                            <tbody id="revenueTable">
                                <!-- åŠ¨æ€ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- æˆæœ¬æ ‡ç­¾é¡µ -->
                <div id="costs" class="tab-content">
                    <div class="model-section">
                        <div class="model-section-title">ğŸ“Š æˆæœ¬ç»“æ„åˆ†æ</div>
                        <div class="chart-container">
                            ğŸ¥§ æˆæœ¬åˆ†å¸ƒé¥¼å›¾ (é›†æˆChart.jsåæ˜¾ç¤º)
                        </div>
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>æˆæœ¬ç±»å‹</th>
                                    <th>æœˆåº¦æˆæœ¬</th>
                                    <th>å¹´åº¦æˆæœ¬</th>
                                    <th>å æ¯”</th>
                                    <th>ä¼˜åŒ–æ½œåŠ›</th>
                                </tr>
                            </thead>
                            <tbody id="costsTable">
                                <!-- åŠ¨æ€ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ç°é‡‘æµæ ‡ç­¾é¡µ -->
                <div id="cashflow" class="tab-content">
                    <div class="model-section">
                        <div class="model-section-title">ğŸ’¸ ç°é‡‘æµé¢„æµ‹</div>
                        <div class="chart-container">
                            ğŸ“ˆ ç°é‡‘æµè¶‹åŠ¿å›¾ (é›†æˆChart.jsåæ˜¾ç¤º)
                        </div>
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>æœˆä»½</th>
                                    <th>æ”¶å…¥</th>
                                    <th>æ”¯å‡º</th>
                                    <th>å‡€ç°é‡‘æµ</th>
                                    <th>ç´¯è®¡ç°é‡‘æµ</th>
                                </tr>
                            </thead>
                            <tbody id="cashflowTable">
                                <!-- åŠ¨æ€ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ROIåˆ†ææ ‡ç­¾é¡µ -->
                <div id="roi" class="tab-content">
                    <div class="model-section">
                        <div class="model-section-title">ğŸ’¼ æŠ•èµ„å›æŠ¥åˆ†æ</div>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">æŠ•èµ„å›æŠ¥ç‡ (ROI)</div>
                                    <div class="metric-trend trend-positive">â†— 300%+</div>
                                </div>
                                <div class="metric-value" id="roiValue">0%</div>
                                <div class="metric-description">åŸºäº3å¹´æœŸé¢„æµ‹</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å‡€ç°å€¼ (NPV)</div>
                                    <div class="metric-trend trend-positive">â†— +Â¥2M</div>
                                </div>
                                <div class="metric-value" id="npvValue">Â¥0</div>
                                <div class="metric-description">æŠ˜ç°åçš„å‡€æ”¶ç›Š</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">å†…éƒ¨æ”¶ç›Šç‡ (IRR)</div>
                                    <div class="metric-trend trend-positive">â†— 45%</div>
                                </div>
                                <div class="metric-value" id="irrValue">0%</div>
                                <div class="metric-description">é¡¹ç›®çš„å†…éƒ¨æ”¶ç›Šç‡</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <div class="metric-label">æŠ•èµ„å›æ”¶æœŸ</div>
                                    <div class="metric-trend trend-positive">â†˜ 12ä¸ªæœˆ</div>
                                </div>
                                <div class="metric-value" id="paybackValue">0ä¸ªæœˆ</div>
                                <div class="metric-description">æ”¶å›åˆå§‹æŠ•èµ„çš„æ—¶é—´</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            ğŸ“Š ROIè¶‹åŠ¿åˆ†æå›¾ (é›†æˆChart.jsåæ˜¾ç¤º)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è´¢åŠ¡æ¨¡å‹æ•°æ®
        let financialData = {
            tokenBudget: 53000,
            efficiencyTarget: 85,
            costSavings: 45,
            userGrowthRate: 20,
            conversionRate: 15,
            averageRevenue: 299,
            aiServiceCost: 8000,
            laborCost: 25000,
            operatingCost: 5000,
            initialInvestment: 500000,
            expectedROI: 300,
            paybackPeriod: 12
        };

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // ç”Ÿæˆè´¢åŠ¡æ¨¡å‹
        function generateModel() {
            updateFinancialData();
            calculateModel();
            renderAllTabs();
        }

        // æ›´æ–°è´¢åŠ¡æ•°æ®
        function updateFinancialData() {
            financialData.tokenBudget = parseInt(document.getElementById('totalTokenBudget').value) || 53000;
            financialData.efficiencyTarget = parseInt(document.getElementById('efficiencyTarget').value) || 85;
            financialData.costSavings = parseInt(document.getElementById('costSavings').value) || 45;
            financialData.userGrowthRate = parseInt(document.getElementById('userGrowthRate').value) || 20;
            financialData.conversionRate = parseInt(document.getElementById('conversionRate').value) || 15;
            financialData.averageRevenue = parseInt(document.getElementById('averageRevenue').value) || 299;
            financialData.aiServiceCost = parseInt(document.getElementById('aiServiceCost').value) || 8000;
            financialData.laborCost = parseInt(document.getElementById('laborCost').value) || 25000;
            financialData.operatingCost = parseInt(document.getElementById('operatingCost').value) || 5000;
            financialData.initialInvestment = parseInt(document.getElementById('initialInvestment').value) || 500000;
            financialData.expectedROI = parseInt(document.getElementById('expectedROI').value) || 300;
            financialData.paybackPeriod = parseInt(document.getElementById('paybackPeriod').value) || 12;
        }

        // è®¡ç®—è´¢åŠ¡æ¨¡å‹
        function calculateModel() {
            // è®¡ç®—æ ¸å¿ƒæŒ‡æ ‡
            const monthlyUsers = 1000; // åˆå§‹ç”¨æˆ·æ•°
            const payingUsers = Math.round(monthlyUsers * financialData.conversionRate / 100);
            const mrr = payingUsers * financialData.averageRevenue;
            const arr = mrr * 12;
            
            const totalMonthlyCosts = financialData.aiServiceCost + financialData.laborCost + financialData.operatingCost;
            const grossProfit = mrr - financialData.aiServiceCost;
            const netProfit = mrr - totalMonthlyCosts;
            
            const grossMargin = mrr > 0 ? (grossProfit / mrr * 100).toFixed(1) : 0;
            const netMargin = mrr > 0 ? (netProfit / mrr * 100).toFixed(1) : 0;
            
            const cac = totalMonthlyCosts / (monthlyUsers * financialData.userGrowthRate / 100);
            const ltv = financialData.averageRevenue * 12; // å‡è®¾å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä¸º1å¹´
            
            // Tokenç›¸å…³è®¡ç®—
            const tokenUsage = (financialData.tokenBudget * financialData.efficiencyTarget / 100 / financialData.tokenBudget * 100).toFixed(1);
            const tokenSavings = totalMonthlyCosts * financialData.costSavings / 100;
            
            // ROIè®¡ç®—
            const annualProfit = netProfit * 12;
            const roi = financialData.initialInvestment > 0 ? (annualProfit / financialData.initialInvestment * 100).toFixed(1) : 0;
            const npv = annualProfit * 3 - financialData.initialInvestment; // ç®€åŒ–NPVè®¡ç®—
            const irr = roi > 0 ? (roi * 0.8).toFixed(1) : 0; // ç®€åŒ–IRRè®¡ç®—
            
            // æ›´æ–°UI
            document.getElementById('mrrValue').textContent = `Â¥${mrr.toLocaleString()}`;
            document.getElementById('arrValue').textContent = `Â¥${arr.toLocaleString()}`;
            document.getElementById('grossMargin').textContent = `${grossMargin}%`;
            document.getElementById('netMargin').textContent = `${netMargin}%`;
            document.getElementById('cacValue').textContent = `Â¥${Math.round(cac).toLocaleString()}`;
            document.getElementById('ltvValue').textContent = `Â¥${ltv.toLocaleString()}`;
            document.getElementById('tokenUsage').textContent = `${tokenUsage}%`;
            document.getElementById('tokenSavings').textContent = `Â¥${Math.round(tokenSavings).toLocaleString()}`;
            document.getElementById('roiValue').textContent = `${roi}%`;
            document.getElementById('npvValue').textContent = `Â¥${Math.round(npv).toLocaleString()}`;
            document.getElementById('irrValue').textContent = `${irr}%`;
            document.getElementById('paybackValue').textContent = `${financialData.paybackPeriod}ä¸ªæœˆ`;
        }

        // æ¸²æŸ“æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
        function renderAllTabs() {
            renderRevenueTable();
            renderCostsTable();
            renderCashflowTable();
        }

        // æ¸²æŸ“æ”¶å…¥è¡¨æ ¼
        function renderRevenueTable() {
            const table = document.getElementById('revenueTable');
            let html = '';
            let cumulativeRevenue = 0;
            let users = 1000;
            
            for (let month = 1; month <= 12; month++) {
                const newUsers = Math.round(users * financialData.userGrowthRate / 100);
                users += newUsers;
                const payingUsers = Math.round(users * financialData.conversionRate / 100);
                const monthlyRevenue = payingUsers * financialData.averageRevenue;
                cumulativeRevenue += monthlyRevenue;
                
                html += `
                    <tr>
                        <td>ç¬¬${month}æœˆ</td>
                        <td class="number">${newUsers.toLocaleString()}</td>
                        <td class="number">${payingUsers.toLocaleString()}</td>
                        <td class="number positive">Â¥${monthlyRevenue.toLocaleString()}</td>
                        <td class="number positive">Â¥${cumulativeRevenue.toLocaleString()}</td>
                    </tr>
                `;
            }
            
            table.innerHTML = html;
        }

        // æ¸²æŸ“æˆæœ¬è¡¨æ ¼
        function renderCostsTable() {
            const table = document.getElementById('costsTable');
            const totalMonthlyCost = financialData.aiServiceCost + financialData.laborCost + financialData.operatingCost;
            
            const costs = [
                {
                    type: 'AIæœåŠ¡æˆæœ¬',
                    monthly: financialData.aiServiceCost,
                    optimization: '30%'
                },
                {
                    type: 'äººåŠ›æˆæœ¬',
                    monthly: financialData.laborCost,
                    optimization: '60%'
                },
                {
                    type: 'è¿è¥æˆæœ¬',
                    monthly: financialData.operatingCost,
                    optimization: '20%'
                }
            ];
            
            let html = '';
            costs.forEach(cost => {
                const percentage = (cost.monthly / totalMonthlyCost * 100).toFixed(1);
                html += `
                    <tr>
                        <td>${cost.type}</td>
                        <td class="number negative">Â¥${cost.monthly.toLocaleString()}</td>
                        <td class="number negative">Â¥${(cost.monthly * 12).toLocaleString()}</td>
                        <td class="number">${percentage}%</td>
                        <td class="number positive">${cost.optimization}</td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // æ¸²æŸ“ç°é‡‘æµè¡¨æ ¼
        function renderCashflowTable() {
            const table = document.getElementById('cashflowTable');
            let html = '';
            let cumulativeCashflow = -financialData.initialInvestment;
            let users = 1000;
            const totalMonthlyCosts = financialData.aiServiceCost + financialData.laborCost + financialData.operatingCost;
            
            for (let month = 1; month <= 12; month++) {
                const newUsers = Math.round(users * financialData.userGrowthRate / 100);
                users += newUsers;
                const payingUsers = Math.round(users * financialData.conversionRate / 100);
                const revenue = payingUsers * financialData.averageRevenue;
                const expenses = totalMonthlyCosts;
                const netCashflow = revenue - expenses;
                cumulativeCashflow += netCashflow;
                
                html += `
                    <tr>
                        <td>ç¬¬${month}æœˆ</td>
                        <td class="number positive">Â¥${revenue.toLocaleString()}</td>
                        <td class="number negative">Â¥${expenses.toLocaleString()}</td>
                        <td class="number ${netCashflow >= 0 ? 'positive' : 'negative'}">Â¥${netCashflow.toLocaleString()}</td>
                        <td class="number ${cumulativeCashflow >= 0 ? 'positive' : 'negative'}">Â¥${cumulativeCashflow.toLocaleString()}</td>
                    </tr>
                `;
            }
            
            table.innerHTML = html;
        }

        // å¯¼å‡ºExcelåŠŸèƒ½
        function exportModel() {
            alert('Excelå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç›‘å¬è¾“å…¥å˜åŒ–
            document.querySelectorAll('.form-input').forEach(input => {
                input.addEventListener('input', function() {
                    updateFinancialData();
                    calculateModel();
                });
            });
            
            // åˆå§‹è®¡ç®—
            calculateModel();
            renderAllTabs();
        });
    </script>
</body>
</html>